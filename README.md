# About `cloudsec`
`cloudsec` is a library and toolkit for formally analyzing security policies in cloud/API systems using Python. It has a modular and extensible architecture allowing it to support multiple backends; 
initially, [z3](https://github.com/z3prover) and [cvc5](https://cvc5.github.io/) will be supported. 
The `cloudsec` project takes influence from a number of related projects, such as the [Z3 Firewall Checker](https://github.com/Z3Prover/FirewallChecker).


## Background
Cloud/API systems are commonly secured through the use of security *policies* -- rules governing the set of  actions that agents (users, services, etc) are authorized to take within the system. For example, AWS uses IAM Policies; Kubernetes provides pod security policies, network policies, RBAC, etc. 

Within this context, a common question arises: given two sets of security policies, `P` and `Q`, are the rules generated by `P` and `Q` equivalent, or is one set strictly more permissive than the other? A particular common case is to let `P` be some existing policy set and let `Q` be a policy set that includes a security vulnerability. In this case, determining that `P` is equivalent to `Q` (or even just that `P=>Q`) establishes that the existing policy set contains a vulnerability. These are the types of questions `cloudsec` tries to help answer.


## Trying it Out

Docker images can be built to try out the `cloudsec` software. The `Makefile` can be used to generate the
images:

```
# generate the images --
$ make build
```

With the images generated, start a container with the `cloudsec` software and examples using `docker`:

```
$ docker run -it --rm --entrypoint=bash --name=sec  jstubbs/cloudsec-exs
```

Start a Python shell and import the examples:

```
# from within the container started above,

>>> from examples import *

>>> checker.p_implies_q()
proved

>>> checker.q_implies_p()
counterexample
[action = "PUT",
 resource_path = "s2/home/jstubbs",
 resource_service = "files",
 resource_tenant = "a2cps",
 principal_username = "jstubbs",
 principal_tenant = "a2cps"]

>>> checker2.p_implies_q()
counterexample
[resource_path = "s2/home/jstubbs/",
 action = "DELETE",
 resource_service = "files",
 resource_tenant = "a2cps",
 principal_username = "jstubbs",
 principal_tenant = "a2cps"]

>>> checker2.q_implies_p()
proved
```

## Development

`cloudsec` includes a test suite based on `pytest`. The Makefile can be used to build
the tests container image and run the tests:

```
# Build the tests image 
$ make build-tests
```

```
# Run the tests
$ make test
```